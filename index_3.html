<!DOCTYPE html>
<html>
    <head>
        <meta charset = "utft-8">
        <title>Robot LEGO</title>
        <link href="robot.css" rel="stylesheet">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">
        <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/tomorrow-night-blue.min.css">
    </head>

    <body>


        <header id = "S3_P1">
            <div class = "container1_3" >

                <a href = "index.html#P1">
                    <div class = "element1_3">
                        <p>Page d'accueil</p>
                    </div>
                </a>

                <a href = "#S3_P2">
                    <div class = "element2_3">
                        <p>Le parcours</p>    
                    </div>
                </a>

                <a href = "#S3_P3">
                    <div class = "element3_3">
                        <p>Programmation</p>
                    </div>
                </a>

                <a href = "#S3_P4">
                    <div class = "element4_3">
                        <p>Vidéo</p>
                    </div>        
                </a> 

                <a href = "index_2.html#S2_P1">
                    <div class = "element5_2">
                        <p>Episode 1</p>
                    </div>        
                </a> 

                <img class ="robot" src = "images/robot.jpg" alt = "robot">
            </div>

        </header> 


        <main>

            <h2>Mission 2</h2>

            <section id = "S3_P2">  <!-- Parcours -->
                <img src = "images/piste 2.png" alt = "parcours mission 3">
                <p>
                    Lors des missions de l'épisode 2, le robot devait dans un premier temps faire 2 tours de piste en suivant une ligne noir sur le parcours et éviter 
                </p>
            </section>








            <section id = "S3_P3">     <!-- programmation -->
                <h3>Programme C</h3>  
                <pre><code class="language-c">
        #pragma config(Sensor, S1,     gyro,           sensorEV3_Gyro)
        #pragma config(Sensor, S2,     colorD,         sensorEV3_Color, modeEV3Color_Color)
        #pragma config(Sensor, S3,     capteurDistance, sensorEV3_Ultrasonic)
        #pragma config(Sensor, S4,     colorG,         sensorEV3_Color, modeEV3Color_Color)
        #pragma config(Motor,  motorA,          moteurGauche,  tmotorEV3_Large, PIDControl, reversed, driveRight, encoder)
        #pragma config(Motor,  motorB,          moteurDroit,   tmotorEV3_Large, PIDControl, reversed, driveRight, encoder)
        //*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//
        
        string test;
        void avance80 (void);
        void tourneD (void);
        void tourneG (void);
    void tourneBD (void);
    void tourneBG (void);
    void arret (void);
    bool isRouge (void);
    bool isWhiteG (void);
    bool isWhiteD (void);
    bool isBlackG (void);
    bool isBlackD (void);
    void evite_obstacle(void);
    void ligne(void);
    
    task main()
    {
        int marche=0;
        int tour=0;
        int tempsArrive;
        bool flagR=false;
        eraseDisplay();
    
    
        
        while(marche==0){
            ligne();
        if(getUSDistance(S3)<25){evite_obstacle();}		//evitement obstacle
    
        if (time1(T2)>2000)flagR=false;				//d�tection des tours
            if(isRouge()&&(flagR==false))
                {
                tour+=1;
                clearTimer(T2);
                flagR=true;
                
                if (tour==1)
                    {
                        clearTimer(T1);
                }
                if(tour==3)
                {
                    marche=1;
                arret();
                tempsArrive=time1(T1)/1000;
                while(1){displayTextLine(8,"temps de courses: %i",tempsArrive);}
            }
            }
        }
    }
    
    void avance80(void)
    {
        motor(moteurGauche)=50;
        motor(moteurDroit)=50;
    }
    
    void tourneD(void)
    {
        motor(moteurGauche)=40;
        motor(moteurDroit)=-40;
        delay(100);
    }
    void tourneG(void)
    {
        motor(moteurGauche)=-40;
        motor(moteurDroit)=40;
        delay(100);
    }
    void tourneBD(void)
    {
        motor(moteurGauche)=127;
        motor(moteurDroit)=-127;
    }
    void tourneBG(void)
    {
        motor(moteurGauche)=-127;
        motor(moteurDroit)=127;
    }
    void arret(void)
    {
        motor(moteurGauche)=0;
        motor(moteurDroit)=0;
    }
    
    bool isRouge (void)
    {
        int colorRd;
        int colorRg;
        colorRg=getColorName(S4);
        colorRd=getColorName(S2);
        if ((colorRg==(int)colorRed)||(colorRd==(int)colorRed)){return true;}
        else return false;
    }
    bool isWhiteD (void)
    {
        int colorWd;
        colorWd=getColorName(S2);
        if (colorWd==(int)colorWhite){return true;}
        else return false;
    }
    bool isWhiteG (void)
    {
        int colorWg;
        colorWg=getColorName(S4);
        if (colorWg==(int)colorWhite){return true;}
        else return false;
    }
    
    bool isBlackD (void)
    {
        int colorBd;
        colorBd=getColorName(S2);
        if (colorBd==(int)colorBlack){return true;}
        else return false;
    }
    bool isBlackG (void)
    {
        int colorBg;
        colorBg=getColorName(S4);
        if (colorBg==(int)colorBlack){return true;}
        else return false;
    }
    
    void evite_obstacle(void)
    {
        motor(moteurGauche)=50;
        motor(moteurDroit)=-30;
        delay(500);
        motor(moteurGauche)=60;
        motor(moteurDroit)=60;
        delay(800);
        motor(moteurGauche)=-30;
        motor(moteurDroit)=60;
        delay(500);
        motor(moteurGauche)=60;
        motor(moteurDroit)=60;
        delay(800);
        motor(moteurGauche)=-60;
        motor(moteurDroit)=70;
        delay(500);
        motor(moteurGauche)=60;
        motor(moteurDroit)=60;
        delay(200);
        while(!isBlackD()){
        motor(moteurGauche)=40;
        motor(moteurDroit)=40;
    }
    }
    
    void ligne(void){
        
        if(isWhiteD() && isWhiteG()){
            avance80();
        }
            while(isBlackD()){
                tourneBD();
                delay(200);
        }
        while(isBlackG()){
            tourneBG();
            delay(200);
        }
    }
                    
                </code></pre>
                <a href="images/code_robotFinal.c" download = "code_RobotFinal.c">
                    <img src = "images/télécharger.jpg" alt =  "lien téléchargement">
                </a>
                <h3>Pour télécharger le code, cliquez ici</h3>
            </section>  
            
            
            <section id = S3_P4>  <!-- test / vidéo -->
                <iframe width="315" height="560" src="https://www.youtube.com/embed/ueIq_nbEABk" title="YouTube video player" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen>
            </iframe>
                <p>
                    Lors de nos tests, nous émettons deux conclusions : le robot ne tourne pas assez et les capteurs de couleur sont trop proches. 
                </p>

                <h3>Le passage</h3>

                <iframe width="560" height="315" src="https://www.youtube.com/embed/05VI0HjOAMs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                <p>
                    Pour le suivi de ligne le robot se débrouille bien, comme la détection de fin de parcours est un peu aléatoire le robot la manque une fois et continue son parcours. <br>
                    La mission 4 rajoute un obstacle qui doit être esquivé par le robot. Notre prise de virage est trop courte et le robot tappe l'obstacle avant de revenir sur la ligne ce qui invalide le test. Ce robot aura quand même été une réussite pour nous. 
                </p>
            </section>

            <a href = "#S3_P1">retourner au début de page</a>
        </main>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
    </body>
  